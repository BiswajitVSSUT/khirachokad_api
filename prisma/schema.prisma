generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model shop {
  id             String     @id @default(uuid())
  name           String
  description    String
  logo           String
  contactNumber  String
  contactNumber2 String?
  contactEmail   String
  postalCode     String?
  blockName      String?
  district       String?
  products       products[]
  reviews        review[]
}

model admin {
  id       String @id @default(uuid())
  name     String
  email    String @unique
  password String
  avatar   String
}

model products {
  id          String @id @default(uuid())
  name        String
  description String
  price       String
  image       String

  shopId         String
  verificationId String   @unique
  expiryDate     DateTime
  createdAt      DateTime @default(now())
  updatedAt      DateTime @default(now())

  shop shop @relation(fields: [shopId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@index([name, price])
}

model review {
  id            String   @id @default(uuid())
  revieweeName  String
  revieweeEmail String
  review        String
  rating        Int      @default(0)
  shopId        String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @default(now())
  shop          shop     @relation(fields: [shopId], references: [id], onDelete: Cascade, onUpdate: Cascade)

  @@unique([revieweeEmail, shopId])
  @@index([revieweeName, revieweeEmail, rating])
}
